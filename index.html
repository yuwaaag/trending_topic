<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN News Room - Final Fix</title>
    <style>
        :root { --accent: #00f2ff; }
        body, html { margin: 0; padding: 0; width: 1920px; height: 1080px; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; color: white; }
        .studio-bg { position: absolute; width: 100%; height: 100%; background: url('studio.jpg') no-repeat center center; background-size: cover; z-index: 1; }
        .display-unit { position: absolute; left: 80px; top: 100px; width: 880px; height: 520px; border: 4px solid var(--accent); z-index: 10; border-radius: 15px; overflow: hidden; background: #111; box-shadow: 0 0 30px rgba(0,242,255,0.3); }
        #trendImg { width: 100%; height: 100%; object-fit: cover; }
        .analysis-box { position: absolute; left: 80px; bottom: 60px; width: 850px; background: rgba(0, 8, 25, 0.95); border-left: 12px solid #1DA1F2; padding: 35px; font-size: 34px; z-index: 15; border-radius: 0 25px 25px 0; line-height: 1.6; font-weight: 600; min-height: 350px; }
        .anchor-container { position: absolute; right: 0; bottom: 0; width: 950px; height: 1080px; z-index: 5; }
        #anchorVideo { width: 100%; height: 100%; object-fit: contain; }
    </style>
</head>
<body>

<div class="studio-bg"></div>
<div class="display-unit">
    <img id="trendImg" src="">
    <div id="trendTitle" style="position:absolute; bottom:0; width:100%; background:rgba(0,0,0,0.85); padding:15px; font-size:35px; border-top:2px solid var(--accent); color: var(--accent);">‡§ñ‡§¨‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£</div>
</div>
<div class="analysis-box" id="analysisText">‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'Interact' ‡§ñ‡•ã‡§≤‡§ï‡§∞ ‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</div>
<div class="anchor-container"><video id="anchorVideo" muted loop playsinline><source src="anchor_video.mp4" type="video/mp4"></video></div>

<script>
    // üî¥ ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡•Ä ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§∏‡§π‡•Ä ‡§≠‡§∞‡•á‡§Ç
    const API_KEY = "AIzaSyBUGHUmJMdxTvDLTrBtiLTN3jZUQ4dspCo"; 
    const SHEET_ID = '1rybhbksHooXt_n1X9xOhvE8ilVneK1V4wx_NHXVlfIo';
    const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`;

    let newsItems = [];
    let currentIdx = 0;

    async function startNews() {
        try {
            const res = await fetch(CSV_URL + '&cb=' + Date.now());
            const text = await res.text();
            newsItems = text.split('\n').slice(1).map(r => r.split(',')[0].replace(/"/g, "").trim()).filter(r => r.length > 2);
            if(newsItems.length > 0) processTopic();
        } catch (e) { document.getElementById('analysisText').innerText = "Google Sheet ‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∞‡§π‡§æ‡•§"; }
    }

    async function processTopic() {
        const topic = newsItems[currentIdx];
        document.getElementById('trendTitle').innerText = topic;
        document.getElementById('analysisText').innerText = "AI ‡§ó‡§π‡§∞‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•Å‡§ï‡•á‡§Ç‡•§";
        
        // ‡§á‡§Æ‡•á‡§ú ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ (‡§Ø‡§π ‡§§‡•ã ‡§Ü‡§™‡§ï‡§æ ‡§ö‡§≤ ‡§π‡•Ä ‡§∞‡§π‡§æ ‡§π‡•à)
        document.getElementById('trendImg').src = `https://image.pollinations.ai/prompt/professional%20news%20visual%20of%20${encodeURIComponent(topic)}?width=880&height=520&nologo=true`;

        // üü¢ API ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§®‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§§‡§∞‡•Ä‡§ï‡§æ
        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `Aap PTN News ke senior analyst hain. Topic "${topic}" par ek bahut bada aur detailed news analysis Hindi mein likhein. Isme gehrai honi chahiye. Kam se kam 150 words ka vishleshan likhein. Sirf Hindi text dein.` }] }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const script = data.candidates[0].content.parts[0].text.trim();
                displayAndSpeak(script);
            } else {
                throw new Error("API No Response");
            }
        } catch (e) {
            // üü° ‡§¨‡•à‡§ï‡§Ö‡§™: ‡§Ö‡§ó‡§∞ AI ‡§´‡•á‡§≤ ‡§π‡•ã ‡§ú‡§æ‡§è, ‡§§‡•ã ‡§≠‡•Ä ‡§è‡§Ç‡§ï‡§∞ ‡§ö‡•Å‡§™ ‡§®‡§π‡•Ä‡§Ç ‡§∞‡§π‡•á‡§ó‡•Ä, ‡§µ‡§π ‡§ó‡§π‡§∞‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ñ‡•Å‡§¶ ‡§ï‡§∞‡•á‡§ó‡•Ä!
            const detailedBackup = `‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§Æ‡•à‡§Ç ‡§π‡•Ç‡§Å ‡§Ü‡§™‡§ï‡•Ä AI ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§è‡§Ç‡§ï‡§∞‡•§ ‡§Ü‡§ú ‡§π‡§Æ ${topic} ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û‡•ã‡§Ç ‡§ï‡§æ ‡§Æ‡§æ‡§®‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§ø‡§∑‡§Ø ‡§¶‡•á‡§∂ ‡§ï‡•Ä ‡§Ö‡§∞‡•ç‡§•‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ ‡§î‡§∞ ‡§∏‡§Æ‡§æ‡§ú ‡§™‡§∞ ‡§ó‡§π‡§∞‡§æ ‡§Ö‡§∏‡§∞ ‡§°‡§æ‡§≤‡•á‡§ó‡§æ‡•§ ‡§á‡§∏ ‡§™‡§∞ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ü‡•Ä‡§Æ ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ú‡•Å‡§ü‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§´‡§ø‡§≤‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•Å‡§è ‡§Ø‡§π ‡§ï‡§π‡§®‡§æ ‡§ó‡§≤‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡§æ ‡§ï‡§ø ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§î‡§∞ ‡§≠‡•Ä ‡§¨‡•ú‡•á ‡§ñ‡•Å‡§≤‡§æ‡§∏‡•á ‡§π‡•ã‡§Ç‡§ó‡•á‡•§ ‡§™‡•Ç‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡•Å‡•ú‡•á ‡§∞‡§π‡•á‡§Ç ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§æ‡§•‡•§`;
            displayAndSpeak(detailedBackup);
        }
    }

    function displayAndSpeak(txt) {
        document.getElementById('analysisText').innerText = txt;
        window.speechSynthesis.cancel();
        
        const msg = new SpeechSynthesisUtterance(txt);
        msg.lang = 'hi-IN';
        msg.rate = 0.9; // ‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∂‡§®‡§≤ ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§ï‡•Ä ‡§∞‡•û‡•ç‡§§‡§æ‡§∞
        
        const video = document.getElementById('anchorVideo');
        msg.onstart = () => video.play();
        msg.onend = () => {
            video.pause();
            currentIdx = (currentIdx + 1) % newsItems.length;
            setTimeout(processTopic, 10000); 
        };
        window.speechSynthesis.speak(msg);
    }

    // üü¢ ‡§¨‡§π‡•Å‡§§ ‡•õ‡§∞‡•Ç‡§∞‡•Ä: OBS ‡§Æ‡•á‡§Ç Interact ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§ï‡§∞ ‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ
    window.onclick = () => startNews();
</script>
</body>
</html>
