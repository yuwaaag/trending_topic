<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN News - Google Sheets Edition</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: 'Segoe UI', sans-serif; color: white; }
        .studio { position: relative; width: 100vw; height: 100vh; background: url('studio.jpg') center/cover; }
        .visual-box { position: absolute; right: 5%; top: 10%; width: 45%; height: 45%; border: 4px solid #00f2ff; border-radius: 10px; overflow: hidden; box-shadow: 0 0 20px #00f2ff; }
        #newsImg { width: 100%; height: 100%; object-fit: cover; transition: opacity 1s; }
        .script-box { position: absolute; left: 5%; top: 10%; width: 40%; height: 65%; background: rgba(0,0,0,0.8); border: 2px solid #333; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        #teleprompter { font-size: 28px; line-height: 1.6; color: #ccc; }
        .anchor-box { position: absolute; right: 0; bottom: 0; width: 50%; height: 100%; pointer-events: none; z-index: 10; }
        video { width: 100%; height: 100%; object-fit: contain; }
        .bottom-ticker { position: absolute; bottom: 0; width: 100%; height: 80px; background: linear-gradient(to right, #ff0000, #990000); display: flex; align-items: center; z-index: 20; border-top: 3px solid #fff; }
        marquee { font-size: 35px; font-weight: bold; width: 100%; }
    </style>
</head>
<body>

<div class="studio">
    <div class="script-box"><div id="teleprompter">à¤¶à¥€à¤Ÿ à¤¸à¥‡ à¤–à¤¬à¤°à¥‡à¤‚ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...</div></div>
    <div class="visual-box"><img id="newsImg" src="https://image.pollinations.ai/prompt/news%20studio?nologo=true"></div>
    <div class="anchor-box"><video id="vid" muted loop><source src="anchor_video.mp4" type="video/mp4"></video></div>
    <div class="bottom-ticker"><marquee scrollamount="12" id="flashTicker">PTN NEWS: à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...</marquee></div>
</div>

<script>
    // ðŸ”´ à¤…à¤ªà¤¨à¥€ Google Sheet CSV à¤²à¤¿à¤‚à¤• à¤¯à¤¹à¤¾à¤ à¤ªà¥‡à¤¸à¥à¤Ÿ à¤•à¤°à¥‡à¤‚
    const sheetUrl = "https://docs.google.com/spreadsheets/d/1rybhbksHooXt_n1X9xOhvE8ilVneK1V4wx_NHXVlfIo/export?format=csv"; 

    let newsData = [];
    let currentIndex = 0;

    async function fetchSheetData() {
        try {
            const response = await fetch(sheetUrl);
            const data = await response.text();
            const rows = data.split('\n').slice(1); // Header à¤›à¥‹à¥œà¤•à¤° à¤¬à¤¾à¤•à¥€ à¤²à¤¾à¤‡à¤¨à¥‡à¤‚
            
            newsData = rows.map(row => {
                const cols = row.split(',');
                return { script: cols[0], visualKey: cols[1], shortFlash: cols[2] };
            }).filter(item => item.script); // à¤–à¤¾à¤²à¥€ à¤²à¤¾à¤‡à¤¨à¥‡à¤‚ à¤¹à¤Ÿà¤¾ à¤¦à¥‡à¤‚

            startNews();
        } catch (err) {
            document.getElementById("teleprompter").innerText = "à¤¶à¥€à¤Ÿ à¤²à¥‹à¤¡ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤¸à¤®à¤¸à¥à¤¯à¤¾: " + err;
        }
    }

    function startNews() {
        if (newsData.length === 0) return;
        const data = newsData[currentIndex];
        
        document.getElementById("teleprompter").innerText = data.script;
        document.getElementById("flashTicker").innerText = data.shortFlash;
        
        // à¤µà¤¿à¥›à¥à¤…à¤² à¤…à¤ªà¤¡à¥‡à¤Ÿ
        const img = document.getElementById("newsImg");
        img.src = `https://image.pollinations.ai/prompt/news%20broadcast%20visual%20for%20${encodeURIComponent(data.visualKey)}?nologo=true`;

        // à¤†à¤µà¤¾à¥›
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(data.script);
        msg.lang = 'hi-IN';
        msg.rate = 0.95;

        const v = document.getElementById("vid");
        msg.onstart = () => v.play();
        msg.onend = () => {
            v.pause();
            currentIndex = (currentIndex + 1) % newsData.length;
            setTimeout(startNews, 3000);
        };
        window.speechSynthesis.speak(msg);
    }

    window.onclick = () => {
        if (!newsData.length) fetchSheetData();
    };
</script>
</body>
</html>
