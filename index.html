<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN News - Final Solution</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: sans-serif; color: white; }
        .studio { position: relative; width: 100vw; height: 100vh; background: url('studio.jpg') center/cover; }
        .news-img { position: absolute; left: 5%; top: 10%; width: 40%; height: 40%; border: 4px solid #00f2ff; border-radius: 12px; overflow: hidden; background: #111; }
        .analysis { position: absolute; left: 5%; bottom: 8%; width: 45%; height: 40%; background: rgba(0,8,20,0.95); border-left: 10px solid red; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .anchor { position: absolute; right: 0; bottom: 0; width: 50%; height: 95%; }
        video { width: 100%; height: 100%; object-fit: contain; }
    </style>
</head>
<body>

<div class="studio">
    <div class="news-img"><img id="newsImg" src="" style="width:100%; height:100%; object-fit:cover;"></div>
    <div class="analysis">
        <h1 id="title" style="color:#00f2ff; font-size: 28px; margin:0;">PTN NEWS</h1>
        <p id="msg" style="font-size: 22px; color: yellow;">‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</p>
    </div>
    <div class="anchor">
        <video id="vid" muted loop><source src="anchor_video.mp4" type="video/mp4"></video>
    </div>
</div>

<script type="importmap">
  { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
</script>

<script type="module">
    import { GoogleGenerativeAI } from "@google/generative-ai";

    let userApiKey = ""; 

    window.runPTN = async function() {
        if (!userApiKey) {
            userApiKey = prompt("‡§Ö‡§™‡§®‡•Ä ‡§®‡§à Gemini API Key ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç:");
            if (!userApiKey) return;
        }

        const msgBox = document.getElementById("msg");
        msgBox.innerHTML = "AI ‡§∏‡•á ‡§§‡§æ‡§ú‡§º‡§æ ‡§ñ‡§¨‡§∞‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à‡§Ç...";

        try {
            const genAI = new GoogleGenerativeAI(userApiKey);
            
            // üî¥ ‡§∏‡•Å‡§ß‡§æ‡§∞: ‡§Ø‡§π‡§æ‡§Å 'gemini-1.5-flash-latest' ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à
            const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash-latest" });

            const result = await model.generateContent("Give me 1 trending news headline in India. Just the topic name.");
            const topic = result.response.text().trim();
            
            document.getElementById("title").innerText = "‡§¨‡•ç‡§∞‡•á‡§ï‡§ø‡§Ç‡§ó: " + topic;
            document.getElementById("newsImg").src = `https://image.pollinations.ai/prompt/news%20on%20${encodeURIComponent(topic)}?nologo=true`;

            const analysisResult = await model.generateContent(`Aap professional news anchor hain. Topic "${topic}" par 100 words ka Hindi analysis karein.`);
            const finalTxt = analysisResult.response.text();
            
            speakNow(finalTxt);
        } catch (err) {
            msgBox.innerHTML = "<span style='color:red;'>‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: " + err.message + "</span>";
            userApiKey = ""; 
        }
    }

    function speakNow(txt) {
        document.getElementById("msg").innerText = txt;
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(txt);
        msg.lang = 'hi-IN';
        msg.rate = 0.95;
        const v = document.getElementById("vid");
        msg.onstart = () => v.play();
        msg.onend = () => { v.pause(); setTimeout(window.runPTN, 15000); };
        window.speechSynthesis.speak(msg);
    }

    window.addEventListener('click', () => window.runPTN(), { once: true });
</script>
</body>
</html>
