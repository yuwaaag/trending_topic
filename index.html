<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN News - Deep Analysis v15</title>
    <style>
        :root { --accent: #00f2ff; }
        body, html { margin: 0; padding: 0; width: 1920px; height: 1080px; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; color: white; }
        .studio-bg { position: absolute; width: 100%; height: 100%; background: url('studio.jpg') no-repeat center center; background-size: cover; z-index: 1; }
        .display-unit { position: absolute; left: 80px; top: 100px; width: 880px; height: 520px; border: 4px solid var(--accent); z-index: 10; border-radius: 15px; overflow: hidden; background: #111; box-shadow: 0 0 30px rgba(0,242,255,0.4); }
        #trendImg { width: 100%; height: 100%; object-fit: cover; }
        .analysis-box { position: absolute; left: 80px; bottom: 60px; width: 850px; background: rgba(0, 8, 25, 0.95); border-left: 12px solid #1DA1F2; padding: 35px; font-size: 32px; z-index: 15; border-radius: 0 25px 25px 0; line-height: 1.5; font-weight: 600; min-height: 350px; box-sizing: border-box; }
        .anchor-container { position: absolute; right: 0; bottom: 0; width: 950px; height: 1080px; z-index: 5; }
        #anchorVideo { width: 100%; height: 100%; object-fit: contain; }
    </style>
</head>
<body>

<div class="studio-bg"></div>
<div class="display-unit">
    <img id="trendImg" src="">
    <div id="trendTitle" style="position:absolute; bottom:0; width:100%; background:rgba(0,0,0,0.85); padding:15px; font-size:35px; border-top:2px solid var(--accent); color: var(--accent);">Analysis Center</div>
</div>
<div class="analysis-box" id="analysisText">‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'Interact' ‡§ñ‡•ã‡§≤‡§ï‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</div>
<div class="anchor-container"><video id="anchorVideo" muted loop playsinline><source src="anchor_video.mp4" type="video/mp4"></video></div>

<script>
    const API_KEY = "AIzaSyBUGHUmJMdxTvDLTrBtiLTN3jZUQ4dspCo"; 
    const SHEET_ID = '1rybhbksHooXt_n1X9xOhvE8ilVneK1V4wx_NHXVlfIo';
    const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`;

    let newsItems = [];
    let currentIdx = 0;

    async function startNews() {
        try {
            const res = await fetch(CSV_URL + '&cb=' + Date.now());
            const text = await res.text();
            newsItems = text.split('\n').slice(1).map(r => r.split(',')[0].replace(/"/g, "").trim()).filter(r => r.length > 2);
            if(newsItems.length > 0) processTopic();
        } catch (e) { document.getElementById('analysisText').innerText = "Google Sheet Connect ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∞‡§π‡•Ä!"; }
    }

    async function processTopic() {
        const topic = newsItems[currentIdx];
        document.getElementById('trendTitle').innerText = topic;
        document.getElementById('analysisText').innerText = "AI ‡§ó‡§π‡§∞‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ (Deep Analysis) ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à...";
        document.getElementById('trendImg').src = `https://image.pollinations.ai/prompt/professional%20news%20infographic%20report%20on%20${encodeURIComponent(topic)}?width=880&height=520&nologo=true`;

        // üü¢ AI ‡§ï‡•ã ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂: "Senior Analyst" ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç
        const promptText = `Aap ek Senior News Analyst hain. Vishay: "${topic}". Is par ek prabhavshali Hindi report taiyar karein. Shuruat namaskar se karein. Topic ki gehrai mein jayein, iske arthik aur samajik pehlu batayein aur aage kya hoga iska vishleshan karein. Kam se kam 8 bade vakya likhein. Sirf Hindi bhasha ka upyog karein.`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: promptText }] }] })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const script = data.candidates[0].content.parts[0].text.trim();
                displayAndSpeak(script);
            } else {
                throw new Error("No Content");
            }
        } catch (e) {
            // üü° SMART BACKUP: ‡§Ö‡§ó‡§∞ AI ‡§´‡•á‡§≤ ‡§π‡•ã ‡§ú‡§æ‡§è, ‡§§‡•ã ‡§≠‡•Ä ‡§ü‡•â‡§™‡§ø‡§ï ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§¨‡•ã‡§≤‡•á‡§ó‡§æ
            const smartBackup = `‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§™‡•Ä‡§ü‡•Ä‡§è‡§® ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§ï‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à‡•§ ‡§Ü‡§ú ‡§ï‡•Ä ‡§¨‡§°‡§º‡•Ä ‡§ñ‡§¨‡§∞ ${topic} ‡§ï‡•ã ‡§≤‡•á‡§ï‡§∞ ‡§π‡•à‡•§ ‡§á‡§∏ ‡§µ‡§ø‡§∑‡§Ø ‡§™‡§∞ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ü‡•Ä‡§Æ ‡§®‡•á ‡§ú‡•ã ‡§°‡•á‡§ü‡§æ ‡§ú‡•Å‡§ü‡§æ‡§Ø‡§æ ‡§π‡•à, ‡§µ‡§π ‡§¨‡§§‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç ‡§á‡§∏‡§ï‡•á ‡§ï‡§à ‡§¨‡§°‡§º‡•á ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•ã ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á‡•§ ‡§Ø‡§π ‡§® ‡§ï‡•á‡§µ‡§≤ ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§ï‡•Ä ‡§®‡§à ‡§¶‡§ø‡§∂‡§æ ‡§≠‡•Ä ‡§§‡§Ø ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§π‡§Æ ‡§á‡§∏ ‡§™‡§∞ ‡§Ö‡§™‡§®‡•Ä ‡§™‡•à‡§®‡•Ä ‡§®‡§ú‡§º‡§∞ ‡§¨‡§®‡§æ‡§è ‡§π‡•Å‡§è ‡§π‡•à‡§Ç‡•§ ‡§™‡•Ç‡§∞‡•Ä ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡•á ‡§∞‡§π‡•á‡§Ç ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§æ‡§•‡•§`;
            displayAndSpeak(smartBackup);
        }
    }

    function displayAndSpeak(txt) {
        document.getElementById('analysisText').innerText = txt;
        window.speechSynthesis.cancel();
        
        const msg = new SpeechSynthesisUtterance(txt);
        msg.lang = 'hi-IN';
        msg.rate = 0.9; 
        
        const video = document.getElementById('anchorVideo');
        msg.onstart = () => video.play();
        msg.onend = () => {
            video.pause();
            currentIdx = (currentIdx + 1) % newsItems.length;
            setTimeout(processTopic, 12000); // 12 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï
        };
        window.speechSynthesis.speak(msg);
    }

    window.onclick = () => startNews();
</script>
</body>
</html>
